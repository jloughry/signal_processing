%
% Paper for the journal Signal Processing, written by Ireneusz Kubiak and
% edited by Joe Loughry. For information on this file please contact Joe
% Loughry at Tel. +1 720 277 7800 (time zone GMT minus 7 hours) or Email:
% Joe.Loughry@cs.du.edu or mailto:Joe.Loughry@gmail.com
%

\documentclass[10pt,a4paper]{article}

\usepackage[english,british]{babel}
\usepackage{graphicx}

\usepackage[obeyspaces,hyphens]{url}
\newcommand{\URL}[1]{$\langle$\url{#1}$\rangle$}
\usepackage[plainpages=false,pdfpagelabels]{hyperref}

\usepackage{setspace} % for \doublespacing
\usepackage{subfig} % for side-by-side subfigures
\usepackage{combelow} % for typesetting the Romainian S-comma \cb{}
\usepackage{authblk} % for author affiliations
\usepackage[binary-units]{siunitx} % for typesetting values with SI units

\begin{document}

\title{\input{title.tex}}

\author{Ireneusz Kubiak}
\affil{Military Communication Institute, Warszawska 22A Str.,
    05-130 Zegrze, Poland \URL{mailto:i.kubiak@wil.waw.pl}}
\author{Joe Loughry}
\affil{University of Denver, Ritchie School of Engineering and Computer
    Science, 2155 East Wesley Avenue, Denver, CO 80208 USA
    \URL{mailto:joe.loughry@cs.du.edu}}

\date{}

\maketitle

\doublespacing

\begin{abstract}
	\input{abstract.tex}
\end{abstract}

\textbf{Keywords:} LED array, laser printer, unintentional emission,
compromising emanations, electromagnetic eavesdropping, electromagnetic
infiltration, recognition and reconstruction, non-invasive data acquisition.

\section{Introduction}

Printers are one of the basic elements of a computer system. They translate
the electronic form of processed data into graphical form during the printing
process. As with every electronic device, printers are sources of
electromagnetic emanations. Besides control signals, which carry no
information ({\it e.g.}, directing the operation of stepper motors or
heaters), there are other signals (useful signals) that are correlated with
the information being processed. Such emissions are called `sensitive' or
`valuable' or `compromising' emanations from the point of view of
electromagnetic protection of processed information. Processed data may
be information displayed on a computer screen or printed (Figure
\ref{figure:Figure_01}).

\begin{figure}[ht]
    \centering
    \includegraphics[width=2.5in]{graphics/Figure" "01.jpg}
    \caption{Laser printer as a source of valuable emissions.}
    \label{figure:Figure_01}
\end{figure}

Like other devices included in a computer system \cite{Kuhn2002,Kubiak2016a},
the printer can be subject to electromagnetic infiltration, or eavesdropping
\cite{Ketenci2015a,Kubiak2016b}. Therefore, efforts to reduce the level of
susceptibility to electromagnetic eavesdropping initiated for such devices.
Organisational and technical solutions \cite{Kubiak2006a} are the most
often-used methods for limiting infiltration
sensitivity of devices.\footnote{An example of an organisational solution
might be establishment of a `control zone' around susceptible devices,
relying on distance to attenuate signals below levels that can be received
outside the control zone.} Technical solutions are limited to changes in the
design of devices that typically increase the cost of such devices and
sometimes limit their functionality. Therefore, it is desirable to find
solutions that avoid these drawbacks and at the same time allow `safe'
processing of classified information \cite{Wasfy2011a,Goel2012a}.

One technical method that is commonly used in the field of electromagnetic
compatibility---both to reduce the amount of electromagnetic interference
emitted from the device and the susceptibility of the device to
electromagnetic disturbance---is the use of differential signals. Analysis
of useful signals and control signals \cite{Kubiak2017d} in the operation of
LED arrays
used in printers shows that such a design was used by printer $B$ in the
operation of its photoconductor exposure system. Is this sufficient, however,
to foil non-invasive information gathering? Research and results are
presented in this article.

\begin{figure*}[ht]
    \centering
    \subfloat[Printer $A$]{\includegraphics[width=2in]{graphics/Figure" "02a.jpg}%
    \label{figure:Figure_02a}}
    \hfil
    \subfloat[Printer $B$]{\includegraphics[width=2in]{graphics/Figure" "02b.jpg}%
    \label{figure:Figure_02b}}
    \caption{Two printers, $A$ and $B$, were tested for sensitive emissions.}
    \label{figure:Figure_02}
\end{figure*}

The clear answer is that the solution adopted in the design of the $B$
printer (Figure \ref{figure:Figure_02b}) significantly reduces the
susceptibility of the device to infiltration, in comparison to the $A$
printer (Figure \ref{figure:Figure_02a}). Moreover, the level of
electromagnetic [emission?] of printer $A$ is higher than that of
typical single and dual diode laser printers \cite{Kubiak2014b}.

\section{The Structure of the Emission Source and the Characteristics of
Useful Signals}

The analyses were carried out on two printers using LED array technology.
Different ways of controlling the LED array---chosen by the printer's
designer---affect the number of useful signals (Figure
\ref{figure:Figure_03}) and the structure of those signals. In the case of
printer $A$ we can distinguish four useful signals and six control
signals. The next ten wires are [ground?] wires. Printer $B$ has eight
useful signals (four differential pairs).

\begin{figure*}[ht]
    \centering
    \subfloat[]{\includegraphics[width=2in]{graphics/Figure" "03a.jpg}%
    \label{figure:Figure_03a}}
    \hfil
    \subfloat[]{\includegraphics[width=2in]{graphics/Figure" "03b.jpg}%
    \label{figure:Figure_03b}}
    \caption{Ribbon cable supplying useful signals to the LED array: (a)
        Printer $A$, (b) Printer $B$.}
    \label{figure:Figure_03}
\end{figure*}

The other signals are control wires and ground wires (thirty-two in all). By
probing signal wires and exercising the printer, we were able to learn their
structure, how the LED array is controlled, and how different print quality
options are achieved depending on the operating mode and the `toner save'
option. Each of the tested printers uses different methods of controlling the
LED array, which can affect the level of electromagnetic emanations. Examples
of waveforms of useful and control signals for printer $A$ are presented
in Figures \ref{figure:Figure_04}--\ref{figure:Figure_06}.

\begin{figure*}[ht]
    \centering
    \subfloat[]{\includegraphics[width=2in]{graphics/Figure" "04a.jpg}%
    \label{figure:Figure_04a}}
    \hfil
    \subfloat[]{\includegraphics[width=2in]{graphics/Figure" "04b.jpg}%
    \label{figure:Figure_04b}}
    \caption{Waveforms of useful signals on pins 2 (lower trace) and 5
        (upper trace) of printer $A$ for: a) the 300 dpi mode and the
        Best option, b) the 300 dpi mode and the Eco option.}

    \label{figure:Figure_04}
\end{figure*}

\begin{figure*}[ht]
    \centering
    \subfloat[]{\includegraphics[width=2in]{graphics/Figure" "05a.jpg}%
    \label{figure:Figure_05a}}
    \hfil
    \subfloat[]{\includegraphics[width=2in]{graphics/Figure" "05b.jpg}%
    \label{figure:Figure_05b}}
    \caption{Waveforms of useful signals on pins 2 (lower trace) and 3 (upper
        trace) of printer $A$ for: a) the 600 dpi mode and the Best
        option, b) the 600 dpi mode and the Eco option.}
    \label{figure:Figure_05}
\end{figure*}

\begin{figure*}[ht]
    \centering
    \subfloat[]{\includegraphics[width=2in]{graphics/Figure" "06a.jpg}%
    \label{figure:Figure_06a}}
    \hfil
    \subfloat[]{\includegraphics[width=2in]{graphics/Figure" "06b.jpg}%
    \label{figure:Figure_06b}}
    \caption{Waveforms of useful signals on pins 2 (lower trace) and 3 (upper
        trace) of printer $A$ for: a) the 1200 dpi mode and the Best
        option, b) the 1200 dpi mode and the Eco option.}
    \label{figure:Figure_06}
\end{figure*}

The structures of useful signals, based on the example of the signal on pin
2, does not change for the 300 dpi and 600 dpi operating modes of the
printer. In the case of the 1200 dpi mode, the frequency of signal repetition
increases by two. The amplitude is constant at approximately \SI{3.5}{\volt}
(Table \ref{table:Table_1}).

\begin{table}[ht]
    \centering
    \begin{tabular}{|c|c|c|}
        \hline
        & \multicolumn{2}{c|}{Parameters of Useful Signal} \\
        \hline
        Operating Mode & Frequency (\si{\kilo\hertz})
                       & Amplitude (\si{\volt}) \\
        \hline
        300 dpi, Eco   & $\sim 4.7$ & 3.5 \\
        300 dpi, Best  & $\sim 4.7$ & 3.5 \\
        600 dpi, Eco   & $\sim 4.7$ & 3.5 \\
        600 dpi, Best  & $\sim 4.7$ & 3.5 \\
        1200 dpi, Eco  & $\sim 9.4$ & 3.5 \\
        1200 dpi, Best & $\sim 9.4$ & 3.5 \\
        \hline
    \end{tabular}
    \caption{Parameters of useful signals of printer $A$ in relation to
        printing parameters.}
    \label{table:Table_1}
\end{table}

The structure of the signal (waveform shape and duty cycle) doesn't change.
This proves that the level of risk of electromagnetic emanations correlated
with the processed (printed) information is not affected by printing quality
(resolution and toner save option), in contrast to the situation found with
single and dual diode laser printers \cite{Kubiak2016b}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=2in]{graphics/Figure" "07.jpg}
    \caption{Waveforms of control signals on pins 6 (lower trace) and 9
        (upper trace) of printer $A$ for the 300 dpi mode and the Best
        option.}
    \label{figure:Figure_07}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=2in]{graphics/Figure" "08.jpg}
    \caption{Waveforms of control signals on pins 6 (lower trace) and 9
        (upper trace) of printer $A$ for the 300 dpi mode and the Eco
        option.}
    \label{figure:Figure_08}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=2in]{graphics/Figure" "09.jpg}
    \caption{Waveforms of control signals on pins 6 (lower trace) and 9
    (upper trace) of printer $A$ in 1200 dpi mode with the Best option.}
    \label{figure:Figure_09}
\end{figure}

For these printers, changes of operating mode print quality options do have
an effect on the structure of useful signals and thus the character of the
source of sensitive RF emissions \cite{Grzesiak2011a,Kubiak2015c}.
Information about the operating mode and print quality for printer $A$ is
encoded in the structure of the control signals (Figures
\ref{figure:Figure_07}--\ref{figure:Figure_10}). The amplitude of these
signals is approximately 4--\SI{5}{\volt}. The pulse repetition frequency
also changes depending on operating mode and the toner save option. But at
the same time, these signals carry no information about the information being
printed \ref{Kubiak2014c,Kuhn2004a}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=2in]{graphics/Figure" "10.jpg}
    \caption{Waveforms of control signals on pins 6 (lower trace) and 9
    (upper trace) of printer $A$ for the 1200 dpi mode and the Eco option.}
    \label{figure:Figure_10}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=2in]{graphics/Figure" "11.jpg}
    \caption{Waveforms of useful signals (one of the differential pairs) of
        printer $B$ for the 1200 dpi mode and the Best option.}
    \label{figure:Figure_11}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=2in]{graphics/Figure" "12.jpg}
    \caption{Waveforms of useful signals (one of the differential pairs) of
        printer $B$ for the 1200 dpi mode and the Eco option.}
    \label{figure:Figure_12}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=2in]{graphics/Figure" "13.jpg}
    \caption{Waveforms of useful signals (one of the differential pairs) of
        printer $B$ for the 600 dpi mode and the Best option.}
    \label{figure:Figure_13}
\end{figure}

Moreover, the amplitude of the control signals is higher than that of the
useful signals. That could mean that control signals could be considered as a
serendipitous source of masking emissions which disturb the reception of
sensitive emanations. This phenomenon is advantageous from an electromagnetic
protection point of view \cite{Ulas2016a,Guerrieri2018a,Loughry2002a}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=2in]{graphics/Figure" "14.jpg}
    \caption{Waveforms of useful signals (one of the differential pairs) of
        printer $B$ for the 600 dpi mode and the Eco option.}
    \label{figure:Figure_14}
\end{figure}

A completely different method of control of the LED array was implemented in
printer $B$ despite using the same xerographic technology of photosensitive
drum. Here, some information about modes of operation and toner save option is
visible in the useful signal. The amplitude of this signal is approximately
\SI{250}{\milli\volt}. The amplitude is less than a tenth of similar signals
in printer [$A$?]. Moreover, the signalling method is differential.
Figures \ref{figure:Figure_11}--\ref{figure:Figure_14} show example waveforms
of useful signals. For these signals, the pulse repetition frequency changes
when printing mode of operation and printout quality are changed (Table
\ref{table:Table_2}). The structure of these signals (duty cycle) does not
change. By analysis of the parameters of useful signals we can derive an
important property crucial to reconstructing images from intercepted RF
signals that contain printed data. In the case of printer $B$, a change of
printing quality (from Eco to Best and {\it vice versa}), for a fixed
printing mode, causes predictable changes of the pulse repetion rate of the
useful signal. For printer $A$, changes to these parameters (printing mode
and printing quality) are not reflected in the behaviour of the useful
signal.

\begin{table}[ht]
    \centering
    \begin{tabular}{|l|c|c|c|}
        \hline
        & \multicolumn{3}{c|}{Signal Parameters} \\
        \hline
        & & \multicolumn{2}{c|}{Amplitude (\si{\milli\volt})} \\
        \hline
        Operating & PRF of Differen-
            & First Differential & Second Differenti- \\
        Mode & tial Signals (\si{\kilo\hertz})
            & Pair (1, 3, 5, 7) & al Pair (2, 4, 6, 8) \\
        \hline
        600 dpi Eco   & 2.07 & $-250$ & $+250$ \\
        600 dpi Best  & 4.14 & $-250$ & $+250$ \\
        1200 dpi Eco  & 4,14 & $-250$ & $+250$ \\
        1200 dpi Best & 8,28 & $-250$ & $+250$ \\
        \hline
    \end{tabular}
    \caption{Parameters of useful signals from printer $B$ in relation to
        printing parameters.}
    \label{table:Table_2}
\end{table}

\section{Reconstructed Images from Sensitive Emissions}

Images of printed data were recreated from recorded (RF) useful signals
transmitted in the wires which supply signals to the LED array. The test
signal bandwidth was determined according to the equation:

$$
B = \frac{W\cdot L\cdot (\text{dpi})^2}{t}
$$

\noindent where:

$B \text{ is the signal bandwidth for printing one pixel}$,

$W \text{ is the width of the printing area in inches}$,

$L \text{ is the length of the printing area in inches}$,

$\text{dpi is the printing resolution in dots per inch}$, and

$t \text{ is the time to print one page}$.



\singlespacing

\bibliographystyle{unsrt}
\bibliography{consolidated_bibtex_file}

\end{document}

